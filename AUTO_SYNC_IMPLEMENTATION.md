# üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ë–ª–æ–∫—á–µ–π–Ω–æ–º

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ —Ä–µ–¥–µ–ø–ª–æ—è –ø—Ä–æ–ø–∞–¥–∞–ª–∏ –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏. –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (–≤ LocalStorage), –∞ –Ω–µ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ.

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º:

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–ª–æ–∫—á–µ–π–Ω

**–ö–æ–≥–¥–∞:** –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è  
**–ö–∞–∫:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –±–µ–∑ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (—á–µ—Ä–µ–∑ Paymaster)

```typescript
// –í App.tsx
useEffect(() => {
  if (gameState.gameStatus === 'won' && gameState.isPlaying === false) {
    // 1. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
    completeLevel(gameState.level, stars);
    
    // 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º
    if (isConnected && address) {
      syncToBlockchain(updatedProgress).catch(error => {
        console.error('Auto-sync failed:', error);
        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é –ø–æ–∑–∂–µ
      });
    }
  }
}, [gameState, isConnected, address]);
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–ª–æ–∫—á–µ–π–Ω–∞

**–ö–æ–≥–¥–∞:** –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞  
**–ö–∞–∫:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º  
**–õ–æ–≥–∏–∫–∞:** –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–≤–µ–∑–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è

```typescript
// –í App.tsx
useEffect(() => {
  const loadBlockchainProgress = async () => {
    if (isConnected && address && isAuthenticated) {
      const mergedProgress = await mergeFromBlockchain(progress);
      updateProgress(() => mergedProgress);
    }
  };
  
  loadBlockchainProgress();
}, [isConnected, address, isAuthenticated]);
```

### 3. –õ–æ–≥–∏–∫–∞ –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ü—Ä–æ–≥—Ä–µ—Å—Å–∞

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞:
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–≤–µ–∑–¥—ã** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è
- ‚úÖ –û–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è **–≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏** (–ª–æ–∫–∞–ª—å–Ω—ã–µ + –±–ª–æ–∫—á–µ–π–Ω)
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å**

```typescript
// –í utils/progressSync.ts
export function mergeProgress(
  local: ProgressData,
  onChain: OnChainProgress
): ProgressData {
  // –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
  const mergedCompleted = new Set([
    ...local.completedLevels,
    ...onChain.completedLevels
  ]);
  
  // –í–∑—è—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–≤–µ–∑–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è
  const mergedStars = new Map(local.levelStars);
  onChain.levelStars.forEach((stars, level) => {
    const currentStars = mergedStars.get(level) ?? 0;
    if (stars > currentStars) {
      mergedStars.set(level, stars);
    }
  });
  
  return {
    completedLevels: mergedCompleted,
    levelStars: mergedStars,
    highestUnlockedLevel: Math.max(
      local.highestUnlockedLevel,
      onChain.highestUnlockedLevel
    ),
    soundEnabled: local.soundEnabled,
  };
}
```

---

## –ö–∞–∫ –≠—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç –∫–æ—à–µ–ª–µ–∫ ‚Üí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. –ü—Ä–æ—Ö–æ–¥–∏—Ç —É—Ä–æ–≤–µ–Ω—å 1 ‚Üí **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–ª–æ–∫—á–µ–π–Ω** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
3. –ü—Ä–æ—Ö–æ–¥–∏—Ç —É—Ä–æ–≤–µ–Ω—å 2 ‚Üí **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–ª–æ–∫—á–µ–π–Ω** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
4. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä
5. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ ‚Üí –ü–æ–¥–∫–ª—é—á–∞–µ—Ç –∫–æ—à–µ–ª–µ–∫ ‚Üí **–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞**

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

1. –ò–º–µ–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å (—É—Ä–æ–≤–Ω–∏ 1-10)
2. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç –∫–æ—à–µ–ª–µ–∫ ‚Üí **–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞** (—É—Ä–æ–≤–Ω–∏ 1-5)
3. **–û–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è:** —É—Ä–æ–≤–Ω–∏ 1-10 (–º–∞–∫—Å–∏–º—É–º –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏ –±–ª–æ–∫—á–µ–π–Ω–∞)
4. –ü—Ä–æ—Ö–æ–¥–∏—Ç —É—Ä–æ–≤–µ–Ω—å 11 ‚Üí **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–ª–æ–∫—á–µ–π–Ω**

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—à–∏–±–∫–∞ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

1. –ü—Ä–æ—Ö–æ–¥–∏—Ç —É—Ä–æ–≤–µ–Ω—å ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è **–Ω–µ —É–¥–∞–ª–∞—Å—å** (–Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
2. –ü—Ä–æ–≥—Ä–µ—Å—Å **—Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ** ‚úÖ
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "Save to Blockchain (Gas-Free)" –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. –ú–æ–∂–µ—Ç **—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é** –ø–æ–∑–∂–µ

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚úÖ –î–ª—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

- **–ù–µ –Ω—É–∂–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫—É** - –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–ª–æ–∫—á–µ–π–Ω–µ
- **–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö** - –ø–æ–¥–∫–ª—é—á–∏–ª –∫–æ—à–µ–ª–µ–∫ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
- **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** - –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ Paymaster (0 ETH)

### ‚úÖ –î–ª—è –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

- **Graceful Fallback** - –µ—Å–ª–∏ –±–ª–æ–∫—á–µ–π–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ** - –ª–æ–∫–∞–ª—å–Ω—ã–π –∏ –±–ª–æ–∫—á–µ–π–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è
- **–†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –∫–Ω–æ–ø–∫–∞ "Save to Blockchain" –Ω–∞ —Å–ª—É—á–∞–π –æ—à–∏–±–æ–∫
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã –ò–∑–º–µ–Ω–µ–Ω—ã

1. **`src/App.tsx`**
   - –î–æ–±–∞–≤–ª–µ–Ω `useSyncManager` hook
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è

2. **`vite.config.ts`**
   - –£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ —á–∞–Ω–∫–æ–≤ –¥–æ 2MB
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ pure annotations
   - –£–ª—É—á—à–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `useSyncManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
- `usePlayerProgress` - —á—Ç–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞
- `useBatchUpdateLevels` - –ø–∞–∫–µ—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π
- `mergeProgress` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏ –±–ª–æ–∫—á–µ–π–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–∞–∫ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å

1. **–ü–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª–µ–∫** ‚Üí –ü—Ä–æ–π–¥–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π
2. **–û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å** ‚Üí –£–≤–∏–¥–∏—à—å –ª–æ–≥–∏:
   ```
   Auto-syncing level 1 to blockchain...
   Auto-syncing level 2 to blockchain...
   ```
3. **–ó–∞–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä** ‚Üí –û—Ç–∫—Ä–æ–π —Å–Ω–æ–≤–∞ ‚Üí –ü–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª–µ–∫
4. **–ü—Ä–æ–≤–µ—Ä—å –ø—Ä–æ–≥—Ä–µ—Å—Å** ‚Üí –í—Å–µ —É—Ä–æ–≤–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–π–¥–µ–Ω—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Basescan

1. –û—Ç–∫—Ä–æ–π [Basescan](https://basescan.org/)
2. –ù–∞–π–¥–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç: `0x93aC1C769aCE5caE403a454cBd236aB2EA7B17F5`
3. –ü–µ—Ä–µ–π–¥–∏ –≤ "Read Contract"
4. –í—ã–∑–æ–≤–∏ `getPlayerProgress(—Ç–≤–æ–π_–∞–¥—Ä–µ—Å)`
5. –£–≤–∏–¥–∏—à—å —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å on-chain

---

## –ß—Ç–æ –î–∞–ª—å—à–µ?

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –£–ª—É—á—à–µ–Ω–∏—è

1. **Batch Sync** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π
2. **Sync Indicator** - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ UI
3. **Retry Logic** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –Ω–µ—É–¥–∞—á–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. **Offline Queue** - –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π –¥–ª—è offline —Ä–µ–∂–∏–º–∞

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –ø—Ä–æ–≥—Ä–µ—Å—Å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–ª–æ–∫—á–µ–π–Ω** –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è** –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ—à–µ–ª—å–∫–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–µ –Ω—É–∂–Ω–æ –Ω–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"! üöÄ
